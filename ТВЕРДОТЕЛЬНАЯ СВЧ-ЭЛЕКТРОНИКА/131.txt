ВОЗМОЖНОСТИ МЕТОДА FDTD ДЛЯ ИССЛЕДОВАНИЯ 
МАТЕРИАЛОВ В ПРЯМОУГОЛЬНОМ ВОЛНОВОДЕ 
 
Е.А. Рябов, И.В. Хайрушев, А.А. Андреев, Б.В. Сергеева 
Саратовский национальный исследовательский  
государственный университет им. Н.Г. Чернышевского 
E-mail: k1u2r3ka@mail.ru 
 
Аннотация: В данной работе демонстрируются результаты численного 
моделирования в программном пакете OpenEMS характеристик коэффициентов 
отражения 
различных 
материалов, 
помещенных 
в 
прямоугольный 
волновод. 
Результаты моделирования демонстрируют смещение характеристик от изменения 
шага сетки. Приводятся сравнения производительности различных компьютеров при 
различных шагах сетки. 
Ключевые слова: FDTD, прямоугольный волновод, СВЧ излучение, OpenEMS, 
коэффициент отражения 
 
Введение 
Исследование 
распространения 
электромагнитных 
волн 
в 
пространстве и взаимодействия с различными материалами представляет 
как фундаментальный интерес, так и открывает широкие прикладные 
возможности по созданию приборов для управления электромагнитными 
волнами. В результате появляется интерес в математическом описании 
взаимодействия электромагнитных волн с различными материалами. 
Одним из самых распространенный методов моделирования является 
метод конечных разностей во временной области (FDTD), он широко 
применяется для моделирования в вычислительной электродинамике и 
заключается 
в 
численном 
решении 
уравнений 
Максвелла 
путем 
нахождения приближенного решения на каждом шаге по времени. Данный 
метод был предложен К.Йи в 1966 году [1] и до сих пор существенно 
улучшается для удовлетворения нужд исследователей. На данный момент 
времени существуют различные программные пакеты как коммерческие, 
так и свободные с открытым исходным кодом, которые имеют различные 
опции, например в распараллеливании вычисления FDTD. Такие 
математические пакеты позволяют проводить моделирование сложных 
структур, состоящих из различных материалов на больших разностных 
сетках с требуемой производительностью и точностью. Но метод FDTD 
имеет недостатки, одним из которых является смещение на полшага сеток 
между электрическими и магнитными полями, что приводит к неточности 
определения геометрии материалов. Оригинальная формулировка метода 
FDTD использует равномерную сетку, и повышение разрешения в ней 
связано со значительным увеличением вычислительной трудоёмкости.  
В 
данной 
работе 
приведены 
результаты 
моделирования 
и 
производительности в программном пакете OpenEMS с различными 
плотностями сетки. 
 

345 
 
1. Подготовка модели и результаты моделирования в OpenEMS 
Для проведения численного моделирования рассматриваем волновод 
WR-90 (сечение 22,86×10,16 мм2, длина 200 мм) в диапазоне частот от 7 до 
13 ГГц, в центре волновода помещается материал с различной ε длиной 30 
мм, полностью заполняющий сечение волновода, до и после которого 
находится вакуум, диэлектрическая проницаемость которого ε = 1.  
Было 
проведено 
численное 
моделирование 
характеристик 
с 
использованием программного пакета OpenEMS [2]. В этом программном 
пакете при численном решении электродинамических задач используется 
метод FDTD, а для взаимодействия с OpenEMS используется скриптовый 
язык Matlab/Octave. OpenEMS позволяет рассчитывать компоненты 
электромагнитного поля в ближней и дальней зоне, S-параметры 
электромагнитных систем, диаграммы направленности антенн, проводить 
импорт и экспорт описания объектов моделирования в заданном формате. 
На рисунке 1 представлена геометрия и расположение объектов для 
OpenEMS в программе AppCSXCAD. 
 
Рис. 1. Демонстрация геометрии и расположения объектов для OpenEMS  
в программе AppCSXCAD. 
 
В ходе моделирования была выбрана равномерная сетка с шагом h от 
0,2 мм до 1,0 мм. На рисунке 2 представлена зависимость коэффициента 
отражения от частоты при различных шагах сетки для материала с ε = 5.  
 
 
Рис. 2. Зависимость коэффициента отражения от частоты при различных шагах сетки 
(от 0,2 мм до 1,0 мм) материала длиной 30 мм и ε = 5. 
 

346 
 
Анализируя частотные зависимости коэффициентов отражения, 
можно наблюдать смещение минимумов при изменении шага сетки. В 
таблице 1 представлены смещения минимумов коэффициентов отражения 
материалов с различной диэлектрической проницаемостью. Смещение 
характеристики при изменении шага сетки связано с границей раздела сред 
материал/вакуум. Вследствие того, что на границу материала попадает 
только сетка электрического или магнитного поля, происходит неточность 
расположения геометрии материала. При уменьшении шага сетки точность 
определения геометрии возрастает, но при этом увеличивается время 
выполнения моделирования.  
 
 
2. Сравнение производительности моделирования OpenEMS 
Для сравнения производительности моделирования использовались 
три компьютера с различными характеристиками (таблица 2), в которых 
информация сохраняется на SSD накопитель. В скрипте для OpenEMS 
была задана команда для вывода производительности и времени 
моделирования.   
Таблица 2. Характеристики компьютеров 
Обозначен
ие 
компьютер
а 
Процессор 
Частота 
процессор
а, ГГц 
Количест
во ядер 
Количеств
о потоков 
Оперативна
я память 
(ОЗУ), ГБ 
Операционна
я система 
A 
AMD A8-
3850 
2,9 
4 
4 
4 
Ubuntu 
R 
AMD Ryzen 
3 2200GE 
3,2 
4 
4 
4 
Debian 
X 
Intel® Xeon® 
CPU E5-2620 
v3 
2,4 
6 
12 
16 
Debian 
 
Было проведено моделирование с различными движками в диапазоне 
шага сетки от 0,2 мм до 1,0 мм. Описание каждого движка приведено в 
Таблица 1. Определение частот минимумов коэффициентов отражения 
ε 
Номер 
минимума 
Минимальное значение, 
ГГц 
Максимальное значение, 
ГГц 
Отклонение, 
ГГц 
2,5 
1 
7,56 
7,74 
0,18 
2 
10,46 
10,73 
0,27 
5 
1 
7,21 
7,33 
0,12 
2 
9,25 
9,46 
0,21 
3 
11,35 
11,56 
0,21 
10 
1 
8,16 
8,34 
0,18 
2 
9,54 
9,75 
0,21 
3 
11,30 
11,59 
0,29 
4 
12,56 
12,72 
0,16 

347 
 
таблице 3. На рисунках 3–4 приведено сравнение скоростей вычисления 
одной ячейки с результатом, выполненном на компьютере A, и шагом 
сетки h = 0,2 мм. Анализируя зависимости можно сделать вывод, что 
распараллеливание дает увеличение производительности при малых шагах 
сетки, причиной этого является процесс создания потоков, на которое 
тратится время. Если время на создание потока больше времени жизни 
этого потока, то происходит увеличение общей продолжительности 
выполнения моделирования. Это наблюдаем с “движком” fastest на 
рисунке 4б с компьютером X при шаге h = 1,0 мм, так как время на 
создание 12 потоков намного больше времени просчета одной итерации по 
времени в каждом из потоков.  
 
Таблица 3. Описание движков 
“Движок” 
Описание 
fastest 
выбирает самую “быструю” из доступных реализаций, что соответствует 
пунктам ниже (по умолчанию). 
basic 
самая простая реализация без аппаратных оптимизаций и поэтому может 
быть скомпилирована для других архитектур без дополнительных усилий. 
sse 
использует встроенные функции SSE для ускорения вычислений FDTD. 
Это доступно только на процессорах с набором инструкций x86 или 
x86_64. 
sse-
compressed 
еще больше оптимизирует “движок” sse, еще более интенсивно используя 
"параллелизм на уровне инструкций". 
MPI 
еще одним преимуществом MPI является то, что задача может быть 
разделена между несколькими компьютерами. 
multithreaded 
numThreads=
n 
multithreaded распараллеливает выполнение sse-compressed “движка” на 
все доступные потоки с помощью MPI. Это может быть особенно полезно 
для систем с несколькими процессорами 
numThreads — Принудительно использует только n потоков 
 
Рис. 3. Демонстрация результатов с компьютера A: а) Зависимость скорости 
вычисления одной ячейки от изменения шага сетки при различных “движках”. б) 
Зависимость скорости вычисления одной ячейки от “движков” при разных шагах 
сетки. 

348 
 
 
Рис. 4. Зависимость скорости вычисления одной ячейки от разных компьютеров 
при различных “движках” с шагом сетки: а) h = 0,2 мм; б) h = 1,0 мм. 
 
На рисунке 3а при распараллеливании с уменьшением шага h с 0,6 
мм до 0,5 мм наблюдается резкое уменьшение скорости, что также 
наблюдается 
на 
других 
компьютерах. 
На 
данное 
явление 
предположительно влияет скорость записи данных либо в оперативную 
память, либо в SSD накопитель. 
Заключение 
В работе был проведен анализ результатов моделирования 
характеристик отражений материала с диэлектрической проницаемостью ε: 
2,5; 5; 10 в программном пакете OpenEMS с равномерной сеткой. 
Наблюдается смещение минимумов коэффициентов отражения при 
изменении шага сетки h от 0,2 до 1,0 мм. Данное смещение связано с 
неточным 
определением 
геометрии 
материала. 
Анализ 
производительности моделирования на трех компьютерах с разной 
конфигурацией на однопоточный алгоритм и распараллеленный алгоритм 
FDTD 
показывает 
увеличение 
скорости 
вычисления 
при 
распараллеливании. При больших шагах и большом количестве потоков 
происходит уменьшение скорости вычисления. Для более точного 
результата и оптимальной скорости моделирования нужно учитывать 
геометрию и шаг сетки.  
Результаты проведенного моделирования будут использованы в 
учебном процессе при проведении занятий по дисциплинам, связанным с 
компьютерным моделированием [4–7] и физикой полупроводников [8–10]. 
Исследование выполнено при финансовой поддержке РФФИ (проект 
№ 20-07-00603 А). 
 
Библиографический список 
1. Yee K. Numerical solution of initial boundary value problems involving 
Maxwell's equations in isotropic media //IEEE Transactions on antennas and propagation. 
1966. V. 14(3). P. 302–307. 

349 
 
2. Liebig T. Rennings A., Held S., Erni D. openEMS–A free and open source 
equivalent‐circuit (EC) FDTD simulation platform supporting cylindrical coordinates 
suitable for the analysis of traveling wave MRI applications // International Journal of 
Numerical Modelling: Electronic Networks, Devices and Fields. 2013. V. 26(6). P. 680–696. 
3. Weiland T.A discretization model for the solution of Maxwell's equations for six-
component fields // Archiv Elektronik und Uebertragungstechnik. 1977. V. 31. P. 116–120. 
4. Сергеев С.А. Компьютер в физической лаборатории: Учеб.- метод. пособие. 
– Саратов: Промышленность Поволжья, 2008. – 368 с. 
5. Сергеев С.А., Сысоев И.В. Компьютер в физической лаборатории: учеб.-
метод. пособие / 2-е издание. – Саратов: Саратовский источник, 2013. 304 с. 
6. Сергеев С.А., Сысоев И.В., Горин Д.А. Основы программирования и анализа 
данных для задач материаловедения, биофизики и физической химии: учеб. пособие. – 
Саратов: Саратовский источник, 2016. 304 с. 
7. Сергеев С.А., Синёв И.В., Горин Д.А. Основы программирования для задач 
биофизики и материаловедения: учеб. пособие. – Саратов: Амирит, 2017. 308 с. 
8. Михайлов 
А.И., 
Сергеев 
С.А. 
Физические 
основы 
твердотельной 
электроники: Учеб. пособие. – Саратов: Изд-во Саратовского университета, 2007. 164 с. 
9. Михайлов А.И., Сергеев С.А., Глуховской Е.Г. Физические основы 
твердотельной электроники и микроэлектроники: Планы семинарских занятий. – 
Саратов: Промышленность Поволжья, 2008. 116 с. 
10. Михайлов 
А.И., 
Сергеев 
С.А. 
Физические 
основы 
твердотельной 
электроники: Учеб. пособие. 2-е изд. – Саратов: Изд-во Саратовского университета, 
2020. 192 с. 
 
 

350