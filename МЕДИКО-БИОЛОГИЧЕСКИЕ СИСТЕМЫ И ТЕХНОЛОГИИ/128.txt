МОДЕЛИРОВАНИЕ ИНТЕРФЕРЕНЦИОННОГО СИГНАЛА  
ПРИ ОПТИЧЕСКОЙ КОГЕРЕНТНОЙ ТОМОГРАФИИ 
КРОВЕНОСНЫХ СОСУДОВ 
 
А.Ю. Потлов, С.В. Фролов 
Тамбовский государственный технический университет 
E-mail: zerner@yandex.ru 
 
Представлен оригинальный подход к компьютерному моделированию процесса 
получения структурного изображения в оптической когерентной томографии. Отличи-
тельными особенностями предложенного подхода являются проверка на пересечение гра-
ницы текущего воксела с помощью усовершенствованного алгоритма Смита и учет влия-
ния на фотонный транспорт потоков биологических жидкостей сквозь плоскость сканиро-
вания.  
Ключевые слова: оптическая когерентная томография, интерференционный сиг-
нал, метод Монте-Карло, алгоритм Смита, фантом кровеносного сосуда, потоки биологи-
ческих жидкостей. 
 
Для разработки высокоточных методов цветового доплеровского кар-
тирования в оптической когерентной томографии (ОКТ) важно иметь воз-
можность эффективно моделировать влияние потока биологической жидко-
сти на интерференционный сигнал [1-4]. В связи с вышесказанным целью ра-
боты является повышение достоверности математического моделирования 
процесса формирования структурного изображения в ОКТ [4-6]. 
Для достижения поставленной цели разработан следующий алгоритм 
(рис. 1.). Рассмотрим основные этапы его работы подробнее. Процесс рас-
пространения фотонов внутри исследуемого образца (биологической ткани) 
включает в себя следующие характерные стадии [1,3,7]: запуск фотона, опре-
деление дистанции свободного пробега, проверка на выполнение граничного 
условия, поглощение и рассеяние. При запуске фотона определяются его 
начальное положение и направления движения. Расчет длины свободного 
пробега между точками взаимодействия со средой осуществляется на основе 
коэффициента рассеяния [1]. Поглощение энергии вычисляется на основе за-

 
92 
кона Бугера-Ламберта-Бера и соответствует непрерывному поглощению 
энергии пучка излучения [2, 8]. Рассеяние характеризует изменение направ-
ления движения фотона в точках взаимодействия и рассчитывается на основе 
фазовой функции Хени-Гринштейна и полярного угла (от 0 до 360 градусов). 
Если показатели преломления текущего участка моделируемого объекта и 
участка, в который переходит пакет фотонов различные, то вероятность пе-
ресечения границы определяется с помощью формулы Френеля. Когда пучок 
фотонов выходит из исследуемой среды внутри области расположения дат-
чика его статистический вес прибавляется к интенсивности ряда пикселей те-
кущего А-скана [1, 3, 9]. 
Поскольку разработанный алгоритм базируется на вокселном подходе 
к описанию геометрии моделируемой среды, пакет фотонов начинает движе-
ние в одном из сегментов массива вокселов. После каждого определения ди-
станции свободного пробега фотона между точками взаимодействия произ-
водится проверка на пересечение границы текущего воксела с помощью усо-
вершенствованного алгоритма Смита [6]. Расстояние до грани, которую пе-
ресекает фотон, определяется сравнением расстояний до плоскостей, содер-
жащих грани воксела, затем наименьшее значение сравнивается с длиной 
свободного пробега, и если расстояние до грани по направлению движения 
пучка меньше этой величины, то фотон перемещается на границу воксела. 
Если показатели преломления текущего воксела и воксела, в который пере-
ходит пакет фотонов различные, то вероятность пересечения границы опре-
деляется с помощью формулы Френеля [1,6]. Значение вероятности пересе-
чения границы затем сравнивается с псевдослучайной величиной и, если оно 
меньше, то фотон переходит в следующий сегмент, а если вероятность пере-
сечения границы больше псевдослучайной величины или равна ей, то фотон 
отражается от границы [6]. В случае, когда фотон переходит в параллело-
грамм с такими же оптическими характеристиками, процедура проверки по-
вторяется уже для новых границ. Фотон снова движется к пересекаемой гра-
нице либо передвигается на оставшееся расстояние, после чего вычисляется 
новая дистанция свободного пробега [7-9]. 
Для моделирования влияния потоков биологических жидкостей внутри 
исследуемой биологической ткани специальным маркером помечается каж-
дый пакет фотонов, который попадает в воксел, соответствующий  внутрисо-
судистому пространству. Далее для каждого такого пакета фотонов произво-
дится корректировка параметров: фазовращение с использованием псевдо-
случайного значения фазора (в диапазоне от 0 до 360 градусов) и дополни-
тельное дискретное поглощение части энергии пучка. 
Вышеописанный алгоритм был практически реализован в среде Lab-
VIEW и протестирован с использованием гидродинамических фантомов кро-
веносных сосудов [10]. Серия компьютерных и физических экспериментов 
[11] показала повышение достоверности моделирования интерференционно-
го сигнала из области внутрисосудистого пространства, что соответствует 
достижению поставленной цели.   

 
93 
 
 
Рисунок 1. Упрощенная блок-схема алгоритма моделирования интерференционного сиг-
нала в ОКТ с учетом влияния потоков биологических жидкостей сквозь плоскость скани-
рования. 
 
Исследование выполнено при финансовой поддержке Российского Фон-
да Фундаментальных Исследований (РФФИ), проект № 18-01-00786 А. 
 

 
94 
Библиографический список 
 
1. Wang R. K., An L. Doppler optical micro-angiography for volumetric imaging of vascular 
perfusion in vivo // Optics Express, 2009, V. 17, №11, P. 8926–8940. 
2. Фролов С.В., Потлов А.Ю., Синдеев С.В. Оценка механических свойств стенок крове-
носных сосудов и высокоточное математическое моделирование гемодинамики в задачах 
выбора потоконаправляющих стентов для проведения эндоваскулярных операций по 
стентированию церебральных артерий [Электронный ресурс] : монография. // Тамбов: 
Изд-во ФГБОУ ВО «ТГТУ», 2018, 1 электрон. опт. диск (CD-ROM). 
3. Bashkatov A.N., Genina E.A., Tuchin V.V. Optical properties of skin, subcutaneous, and 
muscle tissues // Journal of Innovative Optical Health Sciences, 2011, V. 4, P. 9–38. 
4. Potlov A.Yu., Frolov S.V., Proskurin S.G. Color mapping of one specific velocity of a biolog-
ical fluid flows with complex geometry using optical coherence tomography // Proceedings of 
SPIE, 2018, V. 10716, Art. No. 107160A 
5. Proskurin S.G., Potlov A.Yu., Frolov S.V. One specific velocity color mapping using optical 
coherence tomography // Journal of Biomedical Optics, 2015, V. 20, Is. 5, №051034.  
6. Frolov S.V., Potlov A.Yu., Petrov D.A., Proskurin S.G. Modelling of a structural image of a 
biological object obtained by means of optical coherent tomography using the Monte-Carlo 
Method based on the voxel geometry of a medium // Quantum Electronics, 2017, V. 47. №4. P. 
347–354. 
7. Wang R.K., Zhenhe M., Kirkpatrick S.J. Tissue Doppler optical coherence elastography for 
real time strain rate and strain mapping of soft tissue // Applied Physics Letters, 2006, V. 89, P. 
1–3. 
8. Frolov S.V., Sindeev S.V., Liepsch D., Balasso A., Arnold P., Kirschke J.S., Prothmann S., 
Potlov A.Yu. Newtonian and non-Newtonian blood flow at a 90°-Bifurcation of the cerebral ar-
tery: A comparative study of fluid viscosity models // Journal of Mechanics in Medicine and Bi-
ology, 2018, V. 18, №05, Art. No. 1850043. 
9. Larin K.V., Sampson D.D. Optical coherence elastography - OCT at work in tissue biome-
chanics // Biomedical Optics Express, 2017, V. 8, Is. 2, P. 1172–1202. 
10. Патент на изобретение № 2682459 РФ. МПК A61B 6/00, G09B 23/28 Способ формиро-
вания фантомов кровеносных сосудов для эндоскопической оптической когерентной эла-
стографии / Фролов С.В., Потлов А.Ю., Проскурин С.Г., Синдеев С.В.; опубликовано. 
19.03.2019 г. Бюл. № 8. 
11. Proskurin S.G., Potlov A.Yu., Frolov S.V. Doppler mapping of an alternating-sign flow with a 
complex structure using optical coherence tomography // Quantum Electronics, 2014, V. 44, Is. 
1, P. 54–58.